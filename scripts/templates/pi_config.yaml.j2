# Raspberry Pi 5 Node Configuration - {{ node_id }}
# Generated by Ansible provisioning - Sprint 7

# Server Configuration
server:
  host: "{{ server_host }}"
  port: {{ server_port }}
  num_rounds: 10
  min_fit_clients: 2
  min_evaluate_clients: 2
  min_available_clients: 2
  
  # TLS Configuration
  tls:
    enabled: true
    cert_path: "certificates/client-{{ node_id }}.crt"
    key_path: "certificates/client-{{ node_id }}.key"
    ca_path: "certificates/ca.crt"

# Client Configuration
client:
  server_address: "{{ server_host }}:{{ server_port }}"
  client_id: "{{ node_id }}"
  node_type: "raspberry_pi_5"
  
  # Hardware Configuration
  hardware:
    cpu_cores: 4
    memory_gb: 8
    architecture: "aarch64"
    
  # Sensor Configuration
  sensors:
    sense_hat:
      enabled: true
      sample_rate_hz: 1.0
      i2c_address: 0x5c
    adxl345:
      enabled: true
      sample_rate_hz: 100.0
      range: 16  # Â±16g
      i2c_address: 0x53
  
  # Training Configuration
  training:
    batch_size: 32
    local_epochs: 5
    learning_rate: 0.001
    validation_split: 0.2
    max_memory_usage: 6  # GB

# Model Configuration
model:
  lstm:
    input_shape: [24, 2]  # 24 hours, 2 features (temp, humidity)
    lstm_units: 64
    dropout_rate: 0.2
    output_units: 2
  
  autoencoder:
    input_dim: 100  # 100 acceleration samples
    encoding_dim: 32
    learning_rate: 0.001
    batch_size: 64

# Data Configuration
data:
  collection:
    duration_hours: 24
    sample_interval_minutes: 60
    storage_path: "data/{{ node_id }}"
  
  preprocessing:
    normalize: true
    remove_outliers: true
    outlier_threshold: 3.0  # Standard deviations

# MATLAB Configuration
matlab:
  enabled: false  # Disabled on Pi for performance
  octave:
    enabled: true
    executable: "octave-cli"

# Logging Configuration
logging:
  level: "INFO"
  format: "json"
  file: "logs/{{ node_id }}.log"
  max_file_size_mb: 50
  backup_count: 10

# Security Configuration
security:
  differential_privacy:
    enabled: true
    noise_multiplier: 1.0
    l2_norm_clip: 1.0
  
  secure_aggregation:
    enabled: false  # May impact Pi performance

# Performance Configuration
performance:
  max_workers: 2  # Conservative for Pi
  memory_limit_gb: 6
  gpu_enabled: false
  cpu_optimization: true
  
  # Pi-specific optimizations
  pi_optimizations:
    thermal_throttling: true
    power_management: "balanced"
    swap_usage: "minimal"

# Monitoring Configuration
monitoring:
  metrics:
    enabled: true
    port: 9090
    endpoint: "/metrics"
    collection_interval: 30  # seconds
  
  health_check:
    enabled: true
    port: 8081
    endpoint: "/health"
    check_interval: 60  # seconds
    
  # Pi-specific monitoring
  pi_monitoring:
    temperature: true
    cpu_usage: true
    memory_usage: true
    disk_usage: true
    network_stats: true

# Node-specific settings
node:
  id: "{{ node_id }}"
  location: "{{ ansible_hostname }}"
  deployment_time: "{{ ansible_date_time.iso8601 }}"
  ansible_managed: true
